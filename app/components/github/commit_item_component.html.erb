<li class="md:px-6 px-3 py-4 hover:bg-base-200 <%= "border-l-4 border-info" if has_time_log? %>">
  <div class="flex items-start">
    <div class="flex-shrink-0 h-10 w-10">
      <%= image_tag avatar_url,
                    class: "h-10 w-10 rounded-full",
                    alt: author_name,
                    onerror: "this.onerror=null; this.src=#{DEFAULT_AVATAR.to_json}" %>
    </div>
    <div class="md:ml-4 flex-1 min-w-0">
      <div class="flex items-center justify-between">
        <p class="text-sm font-medium text-base-content truncate">
          <%= author_name %>
          <% if owner? %>
            <span class="badge badge-primary badge-sm ml-2">Owner</span>
          <% end %>
        </p>
        <div class="ml-2 flex-shrink-0 flex items-center">
          <a href="<%= @commit.commit_url %>" target="_blank"
             class="badge badge-ghost hover:bg-base-300"
             title="View on GitHub">
            <svg class="h-3 w-3 mr-1 text-base-content/60" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.1-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
            </svg>
            <%= short_sha %>
          </a>
          <div class="text-xs text-base-content/60 ms-2">
            <%= formatted_date %>
          </div>
        </div>
      </div>
      <div class="mt-1 text-sm text-base-content">
        <%= link_to first_line,
                    @commit.commit_url,
                    target: "_blank",
                    class: "link link-primary break-words" %>
      </div>
      <% if has_extended_message? %>
        <div class="mt-1 p-2 text-xs text-base-content/60 bg-base-200 rounded overflow-hidden">
          <div class="line-clamp-2">
            <%= simple_format(extended_message, {}, wrapper_tag: "span") %>
          </div>
        </div>
      <% end %>
      <div class="mt-2 flex items-center text-xs text-base-content/60">
        <div class="flex items-center">
          <svg class="h-3 w-3 text-base-content/50 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <svg class="mr-1.5 h-3.5 w-3.5 text-success" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm.53 5.47a.75.75 0 00-1.06 0l-3 3a.75.75 0 101.06 1.06l1.72-1.72v5.69a.75.75 0 001.5 0v-5.69l1.72 1.72a.75.75 0 101.06-1.06l-3-3z" clip-rule="evenodd" />
          </svg>
          <span class="font-medium text-success"><%= @commit.lines_added %></span>
        </div>
        <span class="inline-flex items-center">
          <svg class="mr-1.5 h-3.5 w-3.5 text-error" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm.53 14.03a.75.75 0 01-1.06 0l-3-3a.75.75 0 111.06-1.06l1.72 1.72V6.75a.75.75 0 011.5 0v7.69l1.72-1.72a.75.75 0 111.06 1.06l-3 3z" clip-rule="evenodd" />
          </svg>
          <span class="font-medium text-error"><%= @commit.lines_removed %></span>
        </span>
      </div>

      <% if has_changed_files? %>
        <div class="mt-3 w-full">
          <input type="checkbox"
                 id="changes-toggle-<%= @commit.id %>"
                 class="hidden peer">

          <label for="changes-toggle-<%= @commit.id %>"
                 class="btn btn-outline btn-sm cursor-pointer inline-flex items-center">
            <svg class="-ml-0.5 mr-1.5 h-4 w-4 text-base-content/60 transition-transform duration-200 peer-checked:rotate-180"
                 xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 20 20"
                 fill="currentColor">
              <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
            <span class="peer-checked:hidden">Show changes</span>
            <span class="hidden peer-checked:inline">Hide changes</span>
          </label>

          <div class="hidden peer-checked:block mt-2 transition-all duration-300">
            <% changed_files.each do |change| %>
              <div class="mt-2 p-3 border border-base-200 rounded-md bg-base-200">
                <div class="flex justify-between items-center">
                  <span class="text-xs font-medium text-base-content/70"><%= change["filename"] %></span>
                  <span class="badge <%= file_status_class(change["status"]) %> badge-sm capitalize">
                    <%= change["status"] %>
                  </span>
                </div>
                <% if change['patch'].present? %>
                  <pre class="mt-2 p-2 text-xs bg-neutral text-neutral-content rounded-md overflow-x-auto"><code><%= change["patch"].gsub('\n', "\n") %></code></pre>
                <% end %>
                <div class="mt-2 flex space-x-4 text-xs text-base-content/60">
                  <span class="inline-flex items-center">
                    <svg class="h-3.5 w-3.5 text-success mr-1" fill="currentColor" viewBox="0 0 24 24">
                      <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm.53 5.47a.75.75 0 00-1.06 0l-3 3a.75.75 0 101.06 1.06l1.72-1.72v5.69a.75.75 0 001.5 0v-5.69l1.72 1.72a.75.75 0 101.06-1.06l-3-3z" clip-rule="evenodd" />
                    </svg>
                    +<%= change["additions"] %>
                  </span>
                  <span class="inline-flex items-center">
                    <svg class="h-3.5 w-3.5 text-error mr-1" fill="currentColor" viewBox="0 0 24 24">
                      <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm.53 14.03a.75.75 0 01-1.06 0l-3-3a.75.75 0 111.06-1.06l1.72 1.72V6.75a.75.75 0 011.5 0v7.69l1.72-1.72a.75.75 0 111.06 1.06l-3 3z" clip-rule="evenodd" />
                    </svg>
                    -<%= change["deletions"] %>
                  </span>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</li>
