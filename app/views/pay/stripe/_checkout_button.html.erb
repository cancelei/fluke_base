<%= button_tag title,
  id: "checkout-#{session.id}",
  class: local_assigns[:class].presence || "btn btn-primary",
  style: local_assigns[:style] %>
<%= tag.div id: "error-for-#{session.id}" %>

<script>
  (() => {
    const checkoutButton = document.getElementById(`checkout-${<%= session.id.to_json %>}`);
    checkoutButton.addEventListener('click', function () {
      Stripe(<%= Pay::Stripe.public_key.to_json.html_safe %>).redirectToCheckout({
        sessionId: <%= session.id.to_json.html_safe %>
      }).then(function (result) {
        if (result.error) {
            document.getElementById("error-for-#{session.id}").innerText = result.error.message;
          }
      });
    });
  })()
</script>
