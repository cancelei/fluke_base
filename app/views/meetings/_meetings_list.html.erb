<%= turbo_frame_tag "#{dom_id(agreement)}_meetings_list" do %>
  <div class="relative overflow-x-auto">
    <% if meetings.any? %>
      <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
        <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
          <tr>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Title
            </th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Date & Time
            </th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Duration
            </th>
            <th scope="col" class="relative px-6 py-3">
              <span class="sr-only">Actions</span>
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <% meetings.each do |meeting| %>
            <%= turbo_frame_tag dom_id(meeting) do %>
              <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 border-gray-200">
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="text-sm font-medium text-gray-900">
                    <%= meeting.title %>
                  </div>
                  <% if meeting.description.present? %>
                    <div class="text-sm text-gray-500 truncate max-w-xs">
                      <%= meeting.description %>
                    </div>
                  <% end %>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="text-sm text-gray-900">
                    <%= meeting.start_time.strftime("%b %d, %Y") %>
                  </div>
                  <div class="text-sm text-gray-500">
                    <%= meeting.start_time.strftime("%I:%M %p") %> - <%= meeting.end_time.strftime("%I:%M %p") %>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                  <%= distance_of_time_in_words(meeting.start_time, meeting.end_time) %>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <div class="flex space-x-2">
                    <%= link_to "Edit", edit_agreement_meeting_path(agreement, meeting),
                        class: "text-indigo-600 hover:text-indigo-900",
                        data: { turbo_frame: "#{dom_id(agreement)}_meeting_form" } %>
                    <%= button_to "Delete", agreement_meeting_path(agreement, meeting),
                        method: :delete,
                        class: "text-red-600 hover:text-red-900 border-none bg-transparent p-0 underline",
                        data: {
                          turbo_confirm: "Are you sure you want to delete this meeting?",
                          turbo_method: :delete
                        } %>
                  </div>
                </td>
              </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <div class="text-center py-6">
        <p class="text-gray-500 text-sm">No meetings scheduled yet.</p>
        <% if agreement.active? %>
          <p class="text-gray-400 text-xs mt-2">
            <%= link_to "Schedule your first meeting",
                new_agreement_meeting_path(agreement),
                class: "text-indigo-600 hover:text-indigo-900",
                data: { turbo_frame: "#{dom_id(agreement)}_meeting_form" } %>
          </p>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>
