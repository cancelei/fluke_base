<%#
  Reusable form field component
  Parameters:
  - form: form builder object
  - field_name: symbol for the field name
  - project: project object for privacy settings
  - label: custom label text (optional)
  - field_type: :text_field, :text_area, :select, etc.
  - options: hash of additional options
  - col_span: grid column span (default: 6)
  - help_text: optional help text
%>

<%
  col_span = local_assigns[:col_span] || 6
  label_text = local_assigns[:label] || field_name.to_s.humanize
  field_options = local_assigns[:options] || {}
  help_text = local_assigns[:help_text]
  base_classes = "block w-full rounded-lg border-gray-200 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
%>

<div class="sm:col-span-<%= col_span %>">
  <%= form.label field_name, label_text, class: "block text-sm font-semibold text-gray-700 mb-2" %>
  <div class="mt-1 flex <%= field_type == :text_area ? "items-start" : "items-center" %>">
    <% case field_type %>
    <% when :text_field %>
      <%= form.text_field field_name, field_options.merge(class: base_classes) %>
    <% when :text_area %>
      <%= form.text_area field_name, field_options.merge(class: base_classes, rows: field_options[:rows] || 3) %>
    <% when :select %>
      <%= form.select field_name,
                     field_options[:choices],
                     field_options[:select_options] || {},
                     field_options.merge(class: base_classes).except(:choices, :select_options) %>
    <% when :url_field %>
      <div class="flex rounded-lg shadow-sm w-full">
        <span class="inline-flex items-center rounded-l-lg border border-r-0 border-gray-200 bg-gray-50 px-3 text-gray-500 sm:text-sm">
          <%= field_options[:prefix] || "https://" %>
        </span>
        <%= form.text_field field_name, field_options.merge(class: "#{base_classes} rounded-l-none").except(:prefix) %>
      </div>
    <% end %>
    <%= render_public_field_checkbox(form, field_name, project) %>
  </div>
  <% if help_text %>
    <p class="mt-1 text-sm text-gray-500"><%= help_text %></p>
  <% end %>
</div>
