#!/usr/bin/env ruby

# Forwarder to unified Rails test task
# Keeps backward compatibility with previous ./bin/test usage

args = ARGV.join(' ')
coverage = args.include?('--coverage')

env = {}
env['COVERAGE'] = 'true' if coverage

puts 'ℹ️  ./bin/test is deprecated. Forwarding to `bundle exec rake test`...'
cmd = ['bundle', 'exec', 'rake', 'test']

if coverage
  # Strip the legacy flag so rake task receives a clean arg list
  filtered = ARGV.reject { |a| a == '--coverage' }
  cmd += filtered
else
  cmd += ARGV
end

exec env, *cmd
